# Interruptions
An interruption is an event that causes the CPU to temporarily halt its current processing and transfer control to a specific routine called an `interrupt handler`. 
The interrupt handler then handles the event and resumes the normal operation of the CPU.

There are 2 types of interruptions:
- `Software Interruption:` Generated by software running on the system.
  _Example:_ division by zero, illegal memory access...
- `Hardware Interruption:` Generated by hardware components of the system.
  _Example:_ Keys being pressed, mouse movement...

# Signal
A signal is a **software interruption**  delivered to a process.
It can come from the OS or another process with privileges.

The goal of a signal is to report exceptional situations to an executing program.

## Signal Generation
Events that generate signals fall into 3 categories:
- `Errors:` a process has done an invalid thing and cannot continue executing _(Example: dividing by 0)_
- `External Events:` For example the arrival of I/O data or a timer that has expired
- `Excplicit requests:` For example the use of the _"kill"_ statement

Signals may be generated `synchronously` _(controlled by the process)_ or `asynchronously` _(outside the control of the process)_

## Types of Signals
Each signal is a **macro** which stands for a positive integer. Which means they are predefined in your code.

Here is he list of predefined signals:
![[Pasted image 20230227173132.png|800]]

The signals are categorized into:
- Errors:
	- `SIGFPE` (8): floating point exception
	- `SIGILL` (4): illegal instruction
	- `SIGSEV` (11): segmentation violation
- Explicit requests:
	- Termination Signals
		- `SIGTERM` (15)
		- `SIGINT` (2)
		- `SIGKILL`
	- Job Control Signals
		- `SIGCHILD` this signal is sent to the parent whenever one of its children terminates
		- `SIGSTOP` (19): Signal that stops the process _(**not terminate it**)_
- Alarms
- Asynchronous I/O
	- `SIGIO` (29)
	- `SIGURG` (23)
- Miscellaneous
	- `SIGUSR1`
	- `SIGUSR2`

## Receiving Signals
When a signal is delivered, a specific action for that signal is taken, which is either of the following:
- Ignore _(Not all signals can be ignored, like SIGKILL and SIGSTOP)_
- Default action _(Most of the time it is terminating the process)_
- Handle the signal _(Most of signals can be handled)_

## Handling Signals
To handle a signal the process must create a `handler`.
The handler is a function that takes the signal number as argument. And it is executed when the signal is received.

To setup this handler function we use the `signal()` function.
```c
sighandler_t signal(int signal_number, sighandler_t Action);
// The Action can be:
// - SIG_DFL (default)
// - SIG_IGN (ignore)
// - handler (pointer to a user defined function)
//            You have to set up the function to
//            take the signal number as a parameter
//            because signal() will parse it this parameter   
```
This function sets up the program to stop everything at hand and execute this function when the signal number is received.

**==NOTE:==** This function is contained in the `<signal.h>` library

### Example
A program that prints a message if it doesnt get input in 69 sex:
```c
void AlarmHandler(int signalNum){
	printf("too slow skipper\n");
}

void main(){
	int numbaah;
	// Sets up the program to
	// stop and execute this function
	// when this signal is received
	signal(SIGALRM, AlarmHandler);
	
	alarm(69);  // Starts an alaram signal 
				// that is sent to this program after 69 secs
	
	// This scanf puts the program in blocking mode
	scanf("%d", &numbaah);
	
	alarm(0); // This disables the alarm and not set the time to 0
}
```

### Functions that can send a signal
- `alarm`: Sends the current program a `SIGALRM` function.
- `kill(int pid, int signal_num)` sends a process the signal with _"signal_num"_